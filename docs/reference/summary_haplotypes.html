<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Haplotypes file summary — summary_haplotypes • stackr</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Haplotypes file summary — summary_haplotypes"><meta property="og:description" content="STACKS batch_x.haplotypes.tsv file summary.
The output of the function is a summary table for populations with:
assembly artifacts and/or sequencing errors: loci with &amp;gt; 2 alleles.
Genotypes with more than 2 alleles are erased before estimating the subsequent statistics.
consensus reads (reads with no variation/polymorphism throughout the dataset).
monomorphic loci (at the population and overall level)
polymorphic loci (at the population and overall level)
haplotypes statistics for the observed and expected homozygosity and
heterozygosity (HOM_O, HOM_E, HET_O, HET_E).
Gene Diversity within populations (Hs) and averaged over all populations.
Not to confuse with Expected Heterozygosity(HET_E).
Here, Hs statistic includes a correction for sampling bias stemming from
sampling a limited number of individuals per population (Nei, 1987).
Wright’s inbreeding coefficient (Fis)
Nei's inbreeding coefficient (Gis) that include a correction for sampling bias.
IBDG: a proxy measure of the realized proportion of the genome
that is identical by descent
FH measure: an individual-base estimate that is
based on the excess in the observed number of homozygous
genotypes within an individual relative to the mean number of homozygous
genotypes expected under random mating (Keller et al., 2011; Kardos et al., 2015).
Pi: the nucleotide diversity (Nei &amp;amp; Li, 1979) measured here consider the
consensus reads in the catalog (no variation between population sequences).
The read.length argument is used directly in the calculations.
To be correctly estimated, the reads obviously need to be of identical size...
PRIVATE_HAPLOTYPES: the number of private haplotypes.

"><meta property="og:image" content="/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">stackr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.2.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/stackr.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/thierrygosselin/stackr" class="external-link">
    <span class="fa fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Haplotypes file summary</h1>
    <small class="dont-index">Source: <a href="https://github.com/thierrygosselin/stackr/blob/HEAD/R/summary_haplotypes.R" class="external-link"><code>R/summary_haplotypes.R</code></a></small>
    <div class="hidden name"><code>summary_haplotypes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>STACKS batch_x.haplotypes.tsv file summary.
The output of the function is a summary table for populations with:</p><ol><li><p>assembly artifacts and/or sequencing errors: loci with &gt; 2 alleles.
Genotypes with more than 2 alleles are erased before estimating the subsequent statistics.</p></li>
<li><p>consensus reads (reads with no variation/polymorphism throughout the dataset).</p></li>
<li><p>monomorphic loci (at the population and overall level)</p></li>
<li><p>polymorphic loci (at the population and overall level)</p></li>
<li><p>haplotypes statistics for the observed and expected homozygosity and
heterozygosity (HOM_O, HOM_E, HET_O, HET_E).</p></li>
<li><p>Gene Diversity within populations (Hs) and averaged over all populations.
Not to confuse with Expected Heterozygosity(HET_E).
Here, Hs statistic includes a correction for sampling bias stemming from
sampling a limited number of individuals per population (Nei, 1987).</p></li>
<li><p>Wright’s inbreeding coefficient (Fis)</p></li>
<li><p>Nei's inbreeding coefficient (Gis) that include a correction for sampling bias.</p></li>
<li><p><strong>IBDG</strong>: a proxy measure of the realized proportion of the genome
that is identical by descent</p></li>
<li><p><strong>FH measure</strong>: an individual-base estimate that is
based on the excess in the observed number of homozygous
genotypes within an individual relative to the mean number of homozygous
genotypes expected under random mating (Keller et al., 2011; Kardos et al., 2015).</p></li>
<li><p><strong>Pi</strong>: the nucleotide diversity (Nei &amp; Li, 1979) measured here consider the
consensus reads in the catalog (no variation between population sequences).
The <code>read.length</code> argument is used directly in the calculations.
To be correctly estimated, the reads obviously need to be of identical size...</p></li>
<li><p><strong>PRIVATE_HAPLOTYPES</strong>: the number of private haplotypes.</p></li>
</ol></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">summary_haplotypes</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  strata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">read.length</span>,</span>
<span>  whitelist.markers <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  blacklist.id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  keep.consensus <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pop.levels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pop.labels <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  artifact.only <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  parallel.core <span class="op">=</span> <span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>The 'batch_x.haplotypes.tsv' created by STACKS.</p></dd>


<dt id="arg-strata">strata<a class="anchor" aria-label="anchor" href="#arg-strata"></a></dt>
<dd><p>A tab delimited file with 2 columns with header:
<code>INDIVIDUALS</code> and <code>STRATA</code>.
The <code>STRATA</code> column can be any hierarchical grouping.
To create a strata file see <a href="https://thierrygosselin.github.io/radiator/reference/individuals2strata.html" class="external-link">individuals2strata</a>.
If you have already run
<a href="http://catchenlab.life.illinois.edu/stacks/" class="external-link">stacks</a> on your data,
the strata file is similar to a stacks `population map file`, make sure you
have the required column names (<code>INDIVIDUALS</code> and <code>STRATA</code>).
The strata also works as a whitelist of ids,
individuals not in the strata file will be removed from the dataset.</p></dd>


<dt id="arg-read-length">read.length<a class="anchor" aria-label="anchor" href="#arg-read-length"></a></dt>
<dd><p>(number) The length in nucleotide of your reads
(e.g. <code>read.length = 100</code>).</p></dd>


<dt id="arg-whitelist-markers">whitelist.markers<a class="anchor" aria-label="anchor" href="#arg-whitelist-markers"></a></dt>
<dd><p>(optional) A whitelist of loci with a column name
'LOCUS'. The whitelist is located in the global environment or in the
directory (e.g. "whitelist.txt").
If a whitelist is used, the files written to the directory will have
'.filtered' in the filename.
Default: <code>whitelist.markers = NULL</code>.</p></dd>


<dt id="arg-blacklist-id">blacklist.id<a class="anchor" aria-label="anchor" href="#arg-blacklist-id"></a></dt>
<dd><p>(optional) A blacklist with individual ID and
a column header 'INDIVIDUALS'. The blacklist is in the global environment
or in the directory (with "blacklist.txt").
Default: <code>blacklist.id = NULL</code>.</p></dd>


<dt id="arg-keep-consensus">keep.consensus<a class="anchor" aria-label="anchor" href="#arg-keep-consensus"></a></dt>
<dd><p>(optional) Using whitelist of markers can automatically
remove consensus markers from the nucleotide diversity (Pi) calculations.
If you know what you are doing, play with this argument
to keep consensus markers.
Default: <code>keep.consensus = TRUE</code>.</p></dd>


<dt id="arg-pop-levels">pop.levels<a class="anchor" aria-label="anchor" href="#arg-pop-levels"></a></dt>
<dd><p>(optional, string) This refers to the levels in a factor. In this
case, the id of the pop.
Use this argument to have the pop ordered your way instead of the default
alphabetical or numerical order. e.g. <code>pop.levels = c("QUE", "ONT", "ALB")</code>
instead of the default <code>pop.levels = c("ALB", "ONT", "QUE")</code>.
White spaces in population names are replaced by underscore.
Default: <code>pop.levels = NULL</code>.</p></dd>


<dt id="arg-pop-labels">pop.labels<a class="anchor" aria-label="anchor" href="#arg-pop-labels"></a></dt>
<dd><p>(optional, string) Use this argument to rename/relabel
your pop or combine your pop. e.g. To combine <code>"QUE"</code> and <code>"ONT"</code>
into a new pop called <code>"NEW"</code>:
(1) First, define the levels for your pop with <code>pop.levels</code> argument:
<code>pop.levels = c("QUE", "ONT", "ALB")</code>.
(2) then, use <code>pop.labels</code> argument:
<code>pop.levels = c("NEW", "NEW", "ALB")</code>.
To rename <code>"QUE"</code> to <code>"TAS"</code>:
<code>pop.labels = c("TAS", "ONT", "ALB")</code>.
Default: <code>pop.labels = NULL</code>. If you find this too complicated,
there is also the <code>strata</code> argument that can do the same thing,
see below.
White spaces in population names are replaced by underscore.</p></dd>


<dt id="arg-artifact-only">artifact.only<a class="anchor" aria-label="anchor" href="#arg-artifact-only"></a></dt>
<dd><p>(optional, logical) With default <code>artifact.only = TRUE</code>,
the function will stop after generating blacklists of artifacts and consensus loci
(no pi, no FH measures). This is faster and useful to run at the beginning of the pipeline.
Run again at the end, with blacklists and whitelists to get reliable estimates of
gene diverisity, IBDG and FH.</p></dd>


<dt id="arg-parallel-core">parallel.core<a class="anchor" aria-label="anchor" href="#arg-parallel-core"></a></dt>
<dd><p>(optional) The number of core for parallel
programming during Pi calculations.
Default: <code>parallel.core = parallel::detectCores() - 1</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>The function returns a list with:</p><ol><li><p>$consensus.pop # if consensus reads are found</p></li>
<li><p>$consensus.loci # if consensus reads are found</p></li>
<li><p>$artifacts.pop # if artifacts are found</p></li>
<li><p>$artifacts.loci # if artifacts are found</p></li>
<li><p>$individual.summary: the individual's info for FH and Pi</p></li>
<li><p>$summary: the summary statistics per populations and averaged over all pops.</p></li>
<li><p>$private.haplotypes: a tibble with LOCUS, POP_ID and private haplotypes</p></li>
<li><p>$private.haplotypes.summary: a summary of the number of private haplotypes per populations</p></li>
</ol><p>Also in the list 3 plots (also written in the folder):</p><ol><li><p>$scatter.plot.Pi.Fh.ind: showing Pi and FH per individuals</p></li>
<li><p>$scatter.plot.Pi.Fh.pop: showing Pi and FH per pop</p></li>
<li><p>$boxplot.pi: showing the boxplot of Pi per pop</p></li>
<li><p>$boxplot.fh: showing the boxplot of FH per pop</p></li>
</ol><p>use $ to access each #' objects in the list.
The function potentially write 4 files in the working directory:
blacklist of unique loci with assembly artifacts and/or sequencing errors
(per individuals and globally), a blacklist of unique consensus loci
and a summary of the haplotype file by population.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Keller MC, Visscher PM, Goddard ME (2011)
Quantification of inbreeding due to distant ancestors and its detection
 using dense single nucleotide polymorphism data. Genetics, 189, 237–249.</p>
<p>Kardos M, Luikart G, Allendorf FW (2015)
Measuring individual inbreeding in the age of genomics: marker-based
measures are better than pedigrees. Heredity, 115, 63–72.</p>
<p>Nei M, Li WH (1979)
Mathematical model for studying genetic variation in terms of
restriction endonucleases.
Proceedings of the National Academy of Sciences of
the United States of America, 76, 5269–5273.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Thierry Gosselin <a href="mailto:thierrygosselin@icloud.com">thierrygosselin@icloud.com</a> and
Anne-Laure Ferchaud <a href="mailto:annelaureferchaud@gmail.com">annelaureferchaud@gmail.com</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># The simplest way to run the function:</span></span></span>
<span class="r-in"><span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu">summary_haplotypes</span><span class="op">(</span></span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="st">"batch_1.haplotypes.tsv"</span>,</span></span>
<span class="r-in"><span>strata <span class="op">=</span> <span class="st">"strata_brook_charr.tsv"</span>,</span></span>
<span class="r-in"><span>read.length <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># if you want pi and fh calculated (ideally on filtered data):</span></span></span>
<span class="r-in"><span><span class="va">sum</span> <span class="op">&lt;-</span> <span class="fu">summary_haplotypes</span><span class="op">(</span></span></span>
<span class="r-in"><span>data <span class="op">=</span> <span class="st">"batch_1.haplotypes.tsv"</span>,</span></span>
<span class="r-in"><span>strata <span class="op">=</span> <span class="st">"strata_brook_charr.tsv"</span>,</span></span>
<span class="r-in"><span>read.length <span class="op">=</span> <span class="fl">90</span>,</span></span>
<span class="r-in"><span>artifact.only <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Thierry Gosselin.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

